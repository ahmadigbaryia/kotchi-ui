<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>KotchiUI - Playground</title>
		<!-- Polyfill for older browsers and those who don't support web components -->
		<script src="https://unpkg.com/@webcomponents/webcomponentsjs@2.4.0/webcomponents-loader.js"></script>
	</head>
	<body>
		<div>
			<h5>Actions</h5>
			<kui-button
				id="getAllSectionsAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Get all sections</kui-button
			>
			<kui-button
				id="getExpandedSectionsAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Get expanded sections</kui-button
			>
			<kui-button
				id="getCollapsedSectionsAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Get collapsed sections</kui-button
			>
			<kui-button
				id="collapseAllSectionsAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Collapse all sections</kui-button
			>
			<kui-button
				id="expandAllSectionsAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Expand all sections</kui-button
			>
			<kui-button
				id="collapseSectionAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Collapse section 2</kui-button
			>
			<kui-button
				id="expandSectionAction"
				kui-style="kui-button-primary"
				kui-size="kui-button-small"
				>Expand section 2</kui-button
			>
		</div>
		<kui-accordion id="accordion-example">
			<kui-section
				kui-title="Section 1"
				kui-icon="fas fa-camera"
				kui-collapsable="kui-collapsable-by-header"
			>
				<p>This is section 1 body</p>
				<div slot="section-actions">
					<kui-icon kui-icon="fas fa-camera"></kui-icon>
				</div>
			</kui-section>
			<kui-section
				kui-title="Section 2"
				kui-icon="fas fa-anchor"
				kui-collapsable="kui-collapsable-by-header"
			>
				<p>This is section 2 body</p>
			</kui-section>
			<kui-section
				kui-title="Section 3"
				kui-icon="fas fa-apple-alt"
				kui-collapsable="kui-collapsable-by-header"
			>
				<p>This is section 3 body</p>
			</kui-section>
		</kui-accordion>
		<div>
			<h5>Output</h5>
			<pre id="output-panel"></pre>
		</div>

		<script>
			const childrenTypes = [
				"kui-accordion",
				"kui-button",
				"kui-section"
			];
			const whenDefinedPromises = [];
			for (let i = 0; i < childrenTypes.length; i++) {
				whenDefinedPromises.push(
					customElements.whenDefined(childrenTypes[i])
				);
			}
			Promise.all(whenDefinedPromises).then(() => {
				const accordion = document.getElementById("accordion-example");
				const outputPanel = document.getElementById("output-panel");
				const getAllSectionsAction = document.getElementById(
					"getAllSectionsAction"
				);
				const getExpandedSectionsAction = document.getElementById(
					"getExpandedSectionsAction"
				);
				const getCollapsedSectionsAction = document.getElementById(
					"getCollapsedSectionsAction"
				);
				const collapseAllSectionsAction = document.getElementById(
					"collapseAllSectionsAction"
				);
				const expandAllSectionsAction = document.getElementById(
					"expandAllSectionsAction"
				);
				const collapseSectionAction = document.getElementById(
					"collapseSectionAction"
				);
				const expandSectionAction = document.getElementById(
					"expandSectionAction"
				);

				getAllSectionsAction.addClickHandler(() => {
					const sections = accordion.getAllSections();
					outputPanel.innerHTML = JSON.stringify(sections, null, 4);
				});
				
				getExpandedSectionsAction.addClickHandler(() => {
					const sections = accordion.getExpandedSections();
					outputPanel.innerHTML = JSON.stringify(sections, null, 4);
				});
				
				getCollapsedSectionsAction.addClickHandler(() => {
					const sections = accordion.getCollapsedSections();
					outputPanel.innerHTML = JSON.stringify(sections, null, 4);
				});
				
				collapseAllSectionsAction.addClickHandler(() => {
					accordion.collapseAllSections();
				});
				
				expandAllSectionsAction.addClickHandler(() => {
					accordion.expandAllSections();
				});
				
				collapseSectionAction.addClickHandler(() => {
					accordion.collapseSection(1);
				});

				expandSectionAction.addClickHandler(() => {
					accordion.expandSection(1);
				});
				const handler1 = accordion.addSectionExpandChangedHandler(({detail}) => {
					console.log("Handler 1: " + detail.component.elements.sectionTitle.innerHTML);
				});
				const handler2 = accordion.addSectionExpandChangedHandler(({detail}) => {
					console.log("Handler 2: " + detail.component.elements.sectionBody.innerHTML);
				});
				setTimeout(() => {
					console.log("Removing handler2");
					accordion.removeSectionExpandChangedHandler(handler2);
					console.log("Changing the collapse icon");
					accordion.setAttribute("kui-collapse-icon", "fas fa-angle-double-up");
				}, 5 * 1000);
			});
		</script>
	</body>
</html>
